# 4. 메모리 관리와 가상 메모리 (운영체제)

---

### 메모리 관리 개요

- 컴퓨터 메모리는 **커널 영역**과 **사용자 프로세스 영역**으로 구분  
- 운영체제는 여러 프로세스가 메모리를 효율적, 안정적으로 사용할 수 있게 관리  
- **메모리 관리의 목표**: 프로그램 적재, 보호, 공유, 효율성 극대화  

---

### 메모리 할당 방식

| 할당 방식       | 설명                          | 특징 및 문제점                  |
|--------------|-----------------------------|-----------------------------|
| 연속 할당 (Contiguous) | 프로세스를 연속된 메모리 공간에 할당       | 단순/빠르지만 외부 단편화 발생 가능       |
| 고정 분할 (Fixed Partition) | 메모리를 고정된 크기로 분할하여 할당         | 내부 단편화 존재, 융통성 떨어짐          |
| 가변 분할 (Variable Partition) | 프로세스 크기에 맞게 메모리 공간 동적 분할  | 외부 단편화 발생, 동적 관리 필요         |

---

### 불연속 할당(Non-contiguous)

| 기법          | 설명                                  | 특징                          |
|-------------|-------------------------------------|-----------------------------|
| 페이징 (Paging)    | 논리 메모리를 같은 크기 페이지로 나누어 물리 메모리 프레임과 매핑 | 외부 단편화 없음, 내부 단편화 있음    |
| 세그멘테이션 (Segmentation) | 논리 메모리를 범위가 다양한 세그먼트로 관리            | 내부 단편화 거의 없으나 외부 단편화 존재 |

---

### 페이징 세부 설명

- 프로세스 논리 주소공간 → 페이지 단위 나눔  
- 물리 메모리는 동일 크기 프레임으로 구성  
- **페이지 테이블**: 논리 주소의 페이지 번호와 물리 주소의 프레임 번호 매핑  
- 부족한 페이지는 **스왑인/스왑아웃**으로 디스크와 메모리 간 이동  

---

### 스왑핑(Swapping)

- 메인 메모리가 부족할 때, 프로세스를 보조 기억장치 스왑 영역으로 이동(스왑아웃)  
- 필요 시 다시 메모리로 불러오기(스왑인)  
- 시스템 부하 및 속도 저하 요소  

---

### 내부·외부 단편화

- **내부 단편화**: 할당된 메모리 공간 내 사용하지 않는 남는 공간  
- **외부 단편화**: 여러 프로세스 배치 중 빈 공간들이 흩어져 연속된 공간 부족  

---

### 메모리 관리 예제: 페이징 FIFO 교체

```python
class PageReplacementFIFO:
    def init(self, capacity):
        self.capacity = capacity
        self.pages = []

    def access_page(self, page):
        if page not in self.pages:
            if len(self.pages) >= self.capacity:
                self.pages.pop(0)
            self.pages.append(page)

    def status(self):
        print("현재 페이지 상태:", self.pages)

pr = PageReplacementFIFO(3)
pr.access_page(3); pr.status()
pr.access_page(2); pr.status()
pr.access_page(1); pr.status()
pr.access_page(4); pr.status()

```

---

### 실행 결과 예시

현재 페이지 상태:
현재 페이지 상태:
현재 페이지 상태:
현재 페이지 상태:

```

- FIFO 정책에 따라 가장 오래된 페이지부터 교체됨을 확인 가능  

---

### 추가 메모리 관리 기술

- **메모리 풀(Memory Pool)**: 동적 메모리 관리를 위해 미리 메모리 블록 할당  
- **가상 메모리**: 실제 메모리 용량 초과 프로세스 실행 가능하게 논리적 주소 공간 확장  

---

### 요약

- 메모리 관리는 운영체제 핵심 기능 중 하나  
- 효율적 자원 배분과 사용성 극대화를 위해 다양한 기법 발전  
- 페이징/세그멘테이션 등으로 단편화 문제 최소화  

---